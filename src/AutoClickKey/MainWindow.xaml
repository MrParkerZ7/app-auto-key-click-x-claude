<Window x:Class="AutoClickKey.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:vm="clr-namespace:AutoClickKey.ViewModels"
        mc:Ignorable="d"
        Title="AutoClickKey"
        Height="500"
        Width="450"
        ResizeMode="CanMinimize"
        WindowStartupLocation="CenterScreen"
        Loaded="Window_Loaded"
        Closing="Window_Closing">

    <Window.DataContext>
        <vm:MainViewModel />
    </Window.DataContext>

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVis"/>

        <Style x:Key="GroupBoxStyle" TargetType="GroupBox">
            <Setter Property="Margin" Value="5"/>
            <Setter Property="Padding" Value="5"/>
        </Style>

        <Style x:Key="LabelStyle" TargetType="TextBlock">
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="0,0,10,0"/>
        </Style>

        <Style x:Key="InputStyle" TargetType="TextBox">
            <Setter Property="Padding" Value="5,3"/>
            <Setter Property="Margin" Value="0,2"/>
        </Style>

        <Style x:Key="ComboStyle" TargetType="ComboBox">
            <Setter Property="Padding" Value="5,3"/>
            <Setter Property="Margin" Value="0,2"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="#2D2D30" Padding="10">
            <TextBlock Text="AutoClickKey"
                       FontSize="20"
                       FontWeight="Bold"
                       Foreground="White"/>
        </Border>

        <!-- Tab Control -->
        <TabControl Grid.Row="1"
                    Margin="10"
                    SelectedIndex="{Binding SelectedTab}">

            <!-- Auto Clicker Tab -->
            <TabItem Header="Auto Clicker">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="10">

                        <!-- Click Options -->
                        <GroupBox Header="Click Options" Style="{StaticResource GroupBoxStyle}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>

                                <TextBlock Grid.Row="0" Grid.Column="0"
                                           Text="Mouse Button:"
                                           Style="{StaticResource LabelStyle}"/>
                                <ComboBox Grid.Row="0" Grid.Column="1"
                                          Style="{StaticResource ComboStyle}"
                                          SelectedIndex="{Binding SelectedMouseButton}">
                                    <ComboBoxItem Content="Left"/>
                                    <ComboBoxItem Content="Right"/>
                                    <ComboBoxItem Content="Middle"/>
                                </ComboBox>

                                <TextBlock Grid.Row="1" Grid.Column="0"
                                           Text="Click Type:"
                                           Style="{StaticResource LabelStyle}"/>
                                <ComboBox Grid.Row="1" Grid.Column="1"
                                          Style="{StaticResource ComboStyle}"
                                          SelectedIndex="{Binding SelectedClickType}">
                                    <ComboBoxItem Content="Single Click"/>
                                    <ComboBoxItem Content="Double Click"/>
                                </ComboBox>

                                <TextBlock Grid.Row="2" Grid.Column="0"
                                           Text="Interval (ms):"
                                           Style="{StaticResource LabelStyle}"/>
                                <TextBox Grid.Row="2" Grid.Column="1"
                                         Style="{StaticResource InputStyle}"
                                         Text="{Binding ClickInterval, UpdateSourceTrigger=PropertyChanged}"/>
                            </Grid>
                        </GroupBox>

                        <!-- Position Options -->
                        <GroupBox Header="Click Position" Style="{StaticResource GroupBoxStyle}">
                            <StackPanel>
                                <RadioButton Content="Current Cursor Position"
                                             IsChecked="{Binding UseCurrentPosition}"
                                             Margin="0,5"/>
                                <RadioButton Content="Fixed Position"
                                             IsChecked="{Binding UseCurrentPosition, Converter={StaticResource InverseBoolConverter}}"
                                             Margin="0,5"/>
                                <Grid Margin="20,5,0,0" IsEnabled="{Binding UseCurrentPosition, Converter={StaticResource InverseBoolConverter}}">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="80"/>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="80"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0" Text="X:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                                    <TextBox Grid.Column="1" Style="{StaticResource InputStyle}"
                                             Text="{Binding FixedX, UpdateSourceTrigger=PropertyChanged}"/>
                                    <TextBlock Grid.Column="2" Text="Y:" VerticalAlignment="Center" Margin="10,0,5,0"/>
                                    <TextBox Grid.Column="3" Style="{StaticResource InputStyle}"
                                             Text="{Binding FixedY, UpdateSourceTrigger=PropertyChanged}"/>
                                    <Button Grid.Column="4" Content="Pick" Margin="10,0,0,0"
                                            Padding="10,3" Command="{Binding PickPositionCommand}"/>
                                </Grid>
                            </StackPanel>
                        </GroupBox>

                        <!-- Repeat Options -->
                        <GroupBox Header="Repeat" Style="{StaticResource GroupBoxStyle}">
                            <StackPanel>
                                <RadioButton Content="Infinite (until stopped)"
                                             IsChecked="{Binding ClickInfinite}"
                                             Margin="0,5"/>
                                <StackPanel Orientation="Horizontal" Margin="0,5">
                                    <RadioButton Content="Repeat" VerticalAlignment="Center"/>
                                    <TextBox Width="80" Margin="10,0"
                                             Style="{StaticResource InputStyle}"
                                             Text="{Binding ClickRepeatCount, UpdateSourceTrigger=PropertyChanged}"
                                             IsEnabled="{Binding ClickInfinite, Converter={StaticResource InverseBoolConverter}}"/>
                                    <TextBlock Text="times" VerticalAlignment="Center"/>
                                </StackPanel>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Auto Keyboard Tab -->
            <TabItem Header="Auto Keyboard">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="10">

                        <!-- Keyboard Mode -->
                        <GroupBox Header="Mode" Style="{StaticResource GroupBoxStyle}">
                            <ComboBox Style="{StaticResource ComboStyle}"
                                      SelectedIndex="{Binding SelectedKeyboardMode}">
                                <ComboBoxItem Content="Type Text"/>
                                <ComboBoxItem Content="Press Key"/>
                            </ComboBox>
                        </GroupBox>

                        <!-- Text Input -->
                        <GroupBox Header="Text to Type" Style="{StaticResource GroupBoxStyle}"
                                  Visibility="{Binding SelectedKeyboardMode, Converter={StaticResource IndexToVisibilityConverter}, ConverterParameter=0}">
                            <TextBox Style="{StaticResource InputStyle}"
                                     Height="60"
                                     TextWrapping="Wrap"
                                     AcceptsReturn="True"
                                     Text="{Binding TextToType, UpdateSourceTrigger=PropertyChanged}"/>
                        </GroupBox>

                        <!-- Key Input -->
                        <GroupBox Header="Key to Press" Style="{StaticResource GroupBoxStyle}"
                                  Visibility="{Binding SelectedKeyboardMode, Converter={StaticResource IndexToVisibilityConverter}, ConverterParameter=1}">
                            <StackPanel>
                                <TextBox Style="{StaticResource InputStyle}"
                                         Text="{Binding SelectedKey, UpdateSourceTrigger=PropertyChanged}"
                                         MaxLength="10"/>
                                <TextBlock Text="Enter key name (e.g., A, Enter, F1, Space)"
                                           FontSize="11" Foreground="Gray" Margin="0,5"/>
                                <StackPanel Orientation="Horizontal" Margin="0,5">
                                    <CheckBox Content="Ctrl" IsChecked="{Binding UseCtrl}" Margin="0,0,15,0"/>
                                    <CheckBox Content="Alt" IsChecked="{Binding UseAlt}" Margin="0,0,15,0"/>
                                    <CheckBox Content="Shift" IsChecked="{Binding UseShift}"/>
                                </StackPanel>
                            </StackPanel>
                        </GroupBox>

                        <!-- Interval -->
                        <GroupBox Header="Interval" Style="{StaticResource GroupBoxStyle}">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <TextBlock Text="Delay (ms):" Style="{StaticResource LabelStyle}"/>
                                <TextBox Grid.Column="1" Style="{StaticResource InputStyle}"
                                         Text="{Binding KeyInterval, UpdateSourceTrigger=PropertyChanged}"/>
                            </Grid>
                        </GroupBox>

                        <!-- Repeat Options -->
                        <GroupBox Header="Repeat" Style="{StaticResource GroupBoxStyle}">
                            <StackPanel>
                                <RadioButton Content="Infinite (until stopped)"
                                             IsChecked="{Binding KeyInfinite}"
                                             Margin="0,5"/>
                                <StackPanel Orientation="Horizontal" Margin="0,5">
                                    <RadioButton Content="Repeat" VerticalAlignment="Center"/>
                                    <TextBox Width="80" Margin="10,0"
                                             Style="{StaticResource InputStyle}"
                                             Text="{Binding KeyRepeatCount, UpdateSourceTrigger=PropertyChanged}"
                                             IsEnabled="{Binding KeyInfinite, Converter={StaticResource InverseBoolConverter}}"/>
                                    <TextBlock Text="times" VerticalAlignment="Center"/>
                                </StackPanel>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Record Tab -->
            <TabItem Header="Record">
                <StackPanel Margin="10">
                    <GroupBox Header="Recording" Style="{StaticResource GroupBoxStyle}">
                        <StackPanel>
                            <TextBlock TextWrapping="Wrap" Margin="0,0,0,10">
                                Record mouse movements and clicks, then play them back.
                            </TextBlock>
                            <StackPanel Orientation="Horizontal">
                                <Button Content="{Binding IsRecording, Converter={StaticResource RecordButtonTextConverter}}"
                                        Width="100" Padding="10,5" Margin="0,0,10,0"
                                        Command="{Binding RecordCommand}"/>
                                <Button Content="Play" Width="100" Padding="10,5"
                                        Command="{Binding PlayCommand}"/>
                            </StackPanel>
                        </StackPanel>
                    </GroupBox>
                </StackPanel>
            </TabItem>
        </TabControl>

        <!-- Status Bar -->
        <Border Grid.Row="2" Background="#F0F0F0" Padding="10,5">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" Text="{Binding StatusText}" VerticalAlignment="Center"/>
                <TextBlock Grid.Column="1" VerticalAlignment="Center" Margin="10,0">
                    <Run Text="Clicks: "/><Run Text="{Binding ClickCount}"/>
                </TextBlock>
                <TextBlock Grid.Column="2" VerticalAlignment="Center" Margin="10,0">
                    <Run Text="Keys: "/><Run Text="{Binding KeyCount}"/>
                </TextBlock>
            </Grid>
        </Border>

        <!-- Control Buttons -->
        <Border Grid.Row="3" Padding="10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <Button Grid.Column="0"
                        Content="{Binding IsRunning, Converter={StaticResource StartStopTextConverter}}"
                        Padding="15,10" Margin="0,0,5,0"
                        FontWeight="Bold"
                        Command="{Binding ToggleCommand}"/>
                <Button Grid.Column="1"
                        Content="Stop (F8)"
                        Padding="15,10" Margin="5,0,0,0"
                        Command="{Binding StopCommand}"/>
            </Grid>
        </Border>
    </Grid>
</Window>
